---
title: Lec3 数据库
createTime: 2025/10/04 22:31:32
permalink: /LearningRoute/t7rnln7w/
---
# 1. 学习内容

## 1.1 MySQL基础知识

### 1.1.1 数据库与表

* **数据库**：存储相关数据的集合，包含多个表。

* **表**：数据库中的数据组织形式，由行（记录）和列（字段）组成。

### 1.1.2 数据类型

* **整型**：INT、TINYINT、BIGINT等。

* **浮点型**：FLOAT、DOUBLE等。

* **字符型**：VARCHAR、CHAR、TEXT等。

* **日期时间型**：DATE、TIME、DATETIME、TIMESTAMP等。

### 1.1.3 约束

* **主键**：唯一标识记录，不能重复或为空。

* **外键**：用于关联不同表的字段，保证数据一致性。

* **唯一约束**：确保某列中的值唯一。

* **非空约束**：禁止列值为空。

### 1.1.4 索引

* **概念**：索引是数据库中一种数据结构，用于快速查询和访问数据。

* **类型**：

  * **单列索引**：针对单个列的索引。

  * **复合索引**：针对多个列的组合索引。

  * **全文索引**：用于快速全文搜索。

* **注意事项**：索引会加快查询速度，但也会增加写入、更新和删除的开销。

### 1.1.5 锁

* **概念**：锁用于控制对数据的并发访问，防止数据不一致。

* **类型**：

  * **共享锁**：多个事务可以同时读取，但不能写入。

  * **排他锁**：事务独占对数据的访问，其他事务不能读取或写入。

* **事务隔离级别**：

  * **读未提交**：允许读取未提交的数据。

  * **读已提交**：只允许读取已提交的数据。

  * **可重复读**：在同一事务中多次读取，结果一致。

  * **串行化**：事务完全隔离，确保数据的一致性。

### 1.1.6 事务管理

* **事务**：一组操作的集合，要么全部成功，要么全部失败。

* **ACID特性**：

  * **原子性**：操作不可分割，全部成功或全部失败。

  * **一致性**：事务执行前后数据保持一致。

  * **隔离性**：多个事务并发执行时相互独立。

  * **持久性**：一旦事务提交，数据永久保存。





# 2. 实践内容

## 2.1 MySQL环境搭建

**内容**：我们需要自己安装一台数据库管理服务DBMS，比如说MySQL，可以在本机或者自己的Linux服务器上面安装一台独立的MySQL，以用于自己的学习和测试。

**目标**：获得一个MySQL的连接url，以及用来登录的账号和密码

**安装方式**：有非常多种，这边出于简单只提供Docker的模式。Docker 是一个流行的容器化技术，用于快速部署和运行应用程序，如果你还不会Docker，那可能还需要学习下Docker的基本概念和使用。

### 环境准备

确保已经安装了 Docker。如果未安装，请参考 [Docker 官方文档](https://docs.docker.com/get-docker/) 来完成安装。

### 1. 拉取 MySQL 镜像

首先，我们需要从 Docker Hub 拉取官方的 MySQL 镜像：

```bash
docker pull mysql
```

**解释：**

* `docker pull`：这是从 Docker Hub（镜像仓库）下载镜像的命令。

* `mysql`：这是我们要拉取的镜像名称，Docker Hub 上有官方的 MySQL 镜像。

### 2.1.2 创建并运行 MySQL 容器

使用拉取的 MySQL 镜像创建一个容器并运行：

```bash
docker run --name my-mysql -e MYSQL_ROOT_PASSWORD=my-secret-pw -d -p 3306:3306 mysql:latest
```

**解释：**

* `docker run`：这个命令用于创建并运行一个新的容器。

* `--name my-mysql`：为这个容器指定名称为 `my-mysql`，方便后续管理。

* `-e MYSQL_ROOT_PASSWORD=my-secret-pw`：通过 `-e` 设置环境变量，在这里我们设置 MySQL 的 root 用户密码为 `my-secret-pw`。

* `-d`：以后台模式运行容器（detach 模式）。

* `mysql:latest`：使用最新版本的 MySQL 镜像。

* `-p 3306:3306`：将主机的 3306 端口映射到容器的 3306 端口。这样你可以通过主机的 `localhost:3306` 访问 MySQL 服务。主机端口在冒号的左侧，容器内部的端口在右侧。`3306` 是 MySQL 服务的默认端口号。

**默认情况下，容器中的数据不会被持久化。如果你停止或删除容器，数据会丢失。为了持久化 MySQL 数据，我们可以将容器中的数据目录挂载到主机上。**

```bash
docker run --name my-mysql -v /my/own/datadir:/var/lib/mysql -e MYSQL_ROOT_PASSWORD=my-secret-pw -d mysql:latest
```

**解释：**

* `-v /my/own/datadir:/var/lib/mysql`：通过 `-v` 选项挂载卷，将主机的 `/my/own/datadir` 目录映射到容器内的 `/var/lib/mysql` 目录。MySQL 的数据库文件都存储在 `/var/lib/mysql` 中，这样可以实现数据的持久化。

### 2.1.3 验证容器是否运行

运行以下命令查看 MySQL 容器的状态：

```bash
docker ps
```

**解释：**

* `docker ps`：列出当前运行中的所有容器。可以看到我们的 `my-mysql` 容器是否正在运行。

### 2.1.4  连接到 MySQL 容器

使用以下命令进入 MySQL 容器内部：

```bash
docker exec -it my-mysql mysql -uroot -p
```

**解释：**

* `docker exec`：这个命令允许我们在运行中的容器内部执行命令。

* `-it`：以交互模式连接到容器，`-i` 保持标准输入打开，`-t` 分配一个伪终端。

* `my-mysql`：这是我们容器的名称。

* `mysql`：我们希望在容器内启动 MySQL 客户端。

* `-uroot`：使用 root 用户登录。

* `-p`：表示我们将在提示时输入密码，这时输入之前设置的 `my-secret-pw`。

### 2.1.5 停止和启动 MySQL 容器

如果想要停止容器，可以使用以下命令：

```bash
docker stop my-mysql
```

**解释：**

* `docker stop`：停止一个运行中的容器。

* `my-mysql`：容器的名称。

再次启动容器时，使用以下命令：

```bash
docker start my-mysql
```

**解释：**

* `docker start`：启动已经停止的容器。

* `my-mysql`：容器的名称。

### 2.1.6 （重点）可视化工具连接到MySQL

#### 2.1.6.1 使用可视化工具（DataGrip）连接到 Docker 中的 MySQL

使用可视化工具如 **DataGrip** 连接到 MySQL 容器中的数据库，可以让数据库管理和查询更加方便。以下是具体的步骤：

#### 2.1.6.2 打开 DataGrip 并创建新连接

* 在 DataGrip 中，点击左上角的 **Database** 面板。

* 右键点击 **Data Source**，然后选择 **MySQL**。

#### 2.1.6.3 配置 MySQL 数据源

在弹出的 **Data Source and Drivers** 窗口中，填写以下信息：

* **Host**: `localhost`（如果你在本机运行 Docker 容器）

* **Port**: `3306`（这是之前映射的端口）

* **User**: `root`（MySQL 的 root 用户）

* **Password**: `my-secret-pw`（之前设置的 root 用户密码）

#### 2.1.6.4 测试连接

* 在填写完这些信息后，点击 **Test Connection** 按钮，DataGrip 将尝试连接到 MySQL 数据库。

* 如果一切正常，DataGrip 会提示连接成功。如果连接失败，检查端口映射和 MySQL 容器的运行状态。

#### 2.1.6.5 保存并管理数据库

* 如果连接成功，点击 **OK** 保存配置。

* 然后你就可以使用 DataGrip 连接到 MySQL 容器中的数据库，执行查询、创建表、管理数据等。

#### 2.1.6.6 常见问题排查

##### 2.1.6.6.1 **连接失败：**

* 检查容器是否正在运行：`docker ps`

* 确认 MySQL 容器的端口 3306 已映射到主机。

* 确认 MySQL 服务正在容器内正常启动：`docker logs my-mysql`

##### 2.1.6.6.2 **防火墙问题：**

* 确保本地或服务器的防火墙没有阻止 3306 端口。如果你是从远程机器连接，可能需要在服务器上开放 3306 端口。

### 2.1.7 删除 MySQL 容器（可选）

如果不再需要这个 MySQL 容器，可以将其删除：

```bash
docker rm my-mysql
```

**解释：**

* `docker rm`：删除容器。

* `my-mysql`：容器的名称。注意：删除前需要先停止容器。

### 2.1.8 查看日志

查看 MySQL 容器的日志（如启动信息或错误日志）：

```bash
docker logs my-mysql
```

**解释：**

* `docker logs`：获取容器的日志输出。

* `my-mysql`：容器的名称。

### 总结

通过以上步骤，你已经成功通过 Docker 部署并运行了 MySQL。以下是常用指令的总结：

* `docker pull`：拉取镜像。

* `docker run`：创建并运行容器。

* `docker exec`：执行容器内的命令。

* `docker ps`：查看运行中的容器。

* `docker stop`：停止容器。

* `docker start`：启动容器。

* `docker rm`：删除容器。

* `docker logs`：查看容器日志。

这样你就可以轻松地使用 Docker 管理和运行 MySQL 服务。



## 2.2 拉取项目代码

直接clone到本地即可进行实践

## 2.3 完成任务&调试

**在README中有关于内容的一切信息。**

## 贡献者

<div class="contributors-list" style="display: flex; gap: 20px; flex-wrap: wrap; margin-top: 20px;">
  <!-- 贡献者 1 -->
  <div style="text-align: center;">
    <img src="https://avatars.githubusercontent.com/u/94302726?v=4" alt="魏知乐" style="width: 80px; border-radius: 50%;" />
    <p style="margin-top: 8px;"><a href="https://github.com/spaceluke" target="_blank">魏知乐</a></p>
  </div>
</div>